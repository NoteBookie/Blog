---
layout: page
title: 回顾我的暑期项目：PerFit
categories:
    - cookies
---

在上个暑假里，我和小伙伴受到RR的蛊惑组了队参加Intel的[比赛](http://www.swcontest.net/)。原因一方面既是课程要求对软件开发的流程做一个考核，另一方面也是想要体验多人协作、自由度较大的开发过程。整个软件开发的过程算得上波折不断，也有值得回忆的地方。

*RR： 我们的指导老师

### 立项：被否决的苦难史

赛题的主要要求是使用Openstack技术，用好RealSense摄像头的予以加分。一看到加的分数的份额……我们就毫不犹豫的选择从RealSense切题。一开始找RR私聊，RR给我们介绍了上一届获奖的两个项目：一个是利用多普勒效应，做到可以悬空挥动手指完成滑动的操作；另一个更有参考价值一些，是利用摄像头识别手语，为聋/哑/正常人分别制作三个客户端，实现交流。RR也提了一些竞赛技巧，说不需要实现的很完整~~（有几个字就不错了）~~。

我们想手语既然可以，那唇语也可以算是一个不错的主意。但是后来多次组会讨论，一致认定唇语的难度太高，而且多个字之间其实几乎不能分辨，也就是说所谓的可拓展性（“未来可以拓展到XXXX个字”）太空洞。于是，我们把计划改成了「用唇语与表情辅助输入」，也就是识别九种表情/唇语，对应九句预输入的语句。此外，组会里也讨论了一些比如什么识别表情判断司机是不是困倦，但是一方面觉得太easy，一方面别的思路也都有了比较好的实现，我们就带着这个题目去找了RR。

RR说了一些反对的意见。他认为表情识别是一个太成熟的东西，而且和Realsense摄像头没什么太大联系，因为任何摄像头都做得到，而且我们的想法看似~~并不~~有趣，但实际没什么实用价值。虽然他说的我有些不认同*，但是环境使人而且时间也比较充分，我们就想着再开开脑洞。

后来我的室友想出了一个我们两个都很喜欢的想法，就是把realsense摄像头绑在台球杆上*，然后通过建模把台球桌的情况复现，分析击球的轨迹。听上去又有些难度，也好玩，也和题目契合。可惜这个题目也被RR和其他组员否决了。虽然我觉得RR似乎并没有听明白我们的想法，但是形势使然，我和室友也就放弃了。游走了一些别的小组，交流中也没有收获太舒服的想法。

*后来也证明用RealSense摄像头做传统摄像头做的事情并无不可，复赛通过率很高。<br/>

*还好没有做，RealSense这块头完全没可能绑到台球杆上。

### 波折中度过审核

最后我们选定了健身作为切入点，想用realsense做健身姿势矫正，然后把数据汇总到服务器做一个统计，也契合openstack的主旨。这个切入点的优点在于实用价值较高，不过我还是有些遗憾，因为心中还是心仪一些更没用没好玩的主题，但是形势比人强，没有办法。

答辩的时候我满心以为老师会问一些更犀利的问题，因为在我眼里：我们这个项目过分依赖于RealSense的表现（Kinect上同类的产品都是微软自己做的），是有很大的风险的。可惜老师完全没关注这个，重点反而放在什么“项目名字太随意”“阳光宅男的名字对我这样的女性用户怎么办”以及项目的时刻表不正确上，实话说，我是有一点气愤的。最后的答辩验收也证明了代码和文档都不看重，重点放在展示视频上，令人有些无奈，但也可以理解。

### 摸上RealSense：code guessing

说好的后置摄像头被Intel鸽了，功能大受打击（距离瞬间变成最远1.2m）。7/10终于拿到摄像头，装好sdk，开始研究RealSense的功能，关于RealSense我会再写一点个人体会，也会放在这个杂文栏目里。

因为在摄像头拿到手之前的这段时间里准备的比较充分，也比较好的选择了unity作为开发工具（事后证明很正确），借用sdk提供的七个case研究sdk的功能。一开始感到悲伤的原因是sdk里写好的tracing脚本的实际效果有些惨淡，但也很快的在交流中知道了一些别的办法，顺利解决。

我们用比较快的进度做完了一个手的模块，实现姿势匹配/评分/记录。但又一个巨大的问题袭来，那就是RealSense说好的全身骨骼追踪也被鸽了。//这是后置摄像头的功能

![](http://i.imgur.com/QKDU3dL.png)

> 在遍读文档后，我表示：再也不相信什么宣传视频了.. 

怎么办呢，没有人能接受运动仅仅是“手部”运动，尽管我们进展不错，但是如果不能至少解决“半身”运动，那么项目就几乎没有实用价值。我们遇到了一开始设想的风险。

### 用传统办法的解决问题

最后我们回归到从深度图“抠出”手臂边缘的思路，这样做事后证明还是有不错的效果的，遗憾之处则是我们只会识别手臂，并且算法上欠缺的精度较多，袖口什么的都会变成干扰项。直接导致最后的俯卧撑功能比较丑陋。

客户端方面用我NGUI这个插件做了UI，也做掉了一个健身应用应该有的「提醒」，「建议」和「统计」，统计方面负责服务器的同学根据拍到的数据设计了一个小算法来分析得分情况，也做好了存储。

![](http://i.imgur.com/RKqMG5s.jpg)

### 回顾整个项目的流程

在项目结束后，我回忆整个开发的过程，最大的一个体会就是知道了一个项目如何从空想落到实处的过程，从一开始的需求分析和架构设计，到后来在开发过程的逐步修改，让我体会到了一个四人小团体在开发小项目时巨大的优越性：随时调整，随时修正。得益于前期充分的阅读资料和运作中的多次微调，我们项目的结构保持在一个比较易维护易拓展的情况下，这是我个人非常开心的，一定程度上冲淡了我对这个题目的别扭感，也比较好的锻炼了代码能力。希望以后在学校里也能有更多尝试的机会。
<p align="right">10/8/2015 9:11:23 PM</p> 
